# ğŸ“– åœ¨çº¿ç¼–è¯‘ç³»ç»Ÿ - å¼€å‘æ–‡æ¡£

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx     â”‚â”€â”€â”€â”€â–¶â”‚  Frontend   â”‚     â”‚   Backend   â”‚
â”‚ (åå‘ä»£ç†)   â”‚     â”‚  (React)    â”‚â—€â”€â”€â”€â–¶â”‚  (Express)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚                     â”‚             â”‚
                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
                    â”‚PostgreSQLâ”‚          â”‚  Redis  â”‚   â”‚ Docker â”‚
                    â”‚   (DB)   â”‚          â”‚ (Queue) â”‚   â”‚Executorâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯é€‰å‹ç†ç”±

1. **å‰ç«¯ - React + TypeScript**
   - å¼ºç±»å‹æ£€æŸ¥ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯
   - ç»„ä»¶åŒ–å¼€å‘ï¼Œæ˜“äºç»´æŠ¤
   - ä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿ

2. **åç«¯ - Node.js + Express**
   - å¼‚æ­¥I/Oï¼Œé«˜å¹¶å‘æ€§èƒ½
   - JavaScriptå…¨æ ˆï¼Œé™ä½å­¦ä¹ æˆæœ¬
   - ä¸°å¯Œçš„ä¸­é—´ä»¶ç”Ÿæ€

3. **æ•°æ®åº“ - PostgreSQL**
   - å¼€æºå…è´¹
   - ACIDäº‹åŠ¡æ”¯æŒ
   - JSONæ”¯æŒï¼Œçµæ´»çš„æ•°æ®ç±»å‹

4. **ç¼“å­˜/é˜Ÿåˆ— - Redis**
   - é«˜æ€§èƒ½å†…å­˜æ•°æ®åº“
   - æ”¯æŒå¤šç§æ•°æ®ç»“æ„
   - æˆç†Ÿçš„æ¶ˆæ¯é˜Ÿåˆ—å®ç°

5. **å®¹å™¨åŒ– - Docker**
   - å®Œç¾çš„ä»£ç éš”ç¦»
   - èµ„æºé™åˆ¶
   - ç¯å¢ƒä¸€è‡´æ€§

## ğŸ“ é¡¹ç›®ç»“æ„è¯¦è§£

### å‰ç«¯ç»“æ„
```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/      # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Layout/      # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Header.tsx   # å¤´éƒ¨å¯¼èˆª
â”‚   â”‚   â””â”€â”€ CodeEditor.tsx # ä»£ç ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ pages/           # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ HomePage.tsx
â”‚   â”‚   â”œâ”€â”€ EditorPage.tsx
â”‚   â”‚   â”œâ”€â”€ LoginPage.tsx
â”‚   â”‚   â”œâ”€â”€ RegisterPage.tsx
â”‚   â”‚   â””â”€â”€ HistoryPage.tsx
â”‚   â”œâ”€â”€ hooks/           # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â””â”€â”€ useExecuteCode.ts
â”‚   â”œâ”€â”€ store/           # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ authStore.ts
â”‚   â”œâ”€â”€ services/        # APIæœåŠ¡
â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â””â”€â”€ main.tsx         # å…¥å£æ–‡ä»¶
```

### åç«¯ç»“æ„
```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/     # æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”œâ”€â”€ execute.controller.ts
â”‚   â”‚   â””â”€â”€ submission.controller.ts
â”‚   â”œâ”€â”€ routes/          # è·¯ç”±å®šä¹‰
â”‚   â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”œâ”€â”€ errorHandler.ts
â”‚   â”‚   â”œâ”€â”€ rateLimiter.ts
â”‚   â”‚   â””â”€â”€ validator.ts
â”‚   â”œâ”€â”€ services/        # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ docker.service.ts
â”‚   â”œâ”€â”€ workers/         # ä»»åŠ¡å¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ execute.worker.ts
â”‚   â”œâ”€â”€ queues/          # é˜Ÿåˆ—å®šä¹‰
â”‚   â”‚   â””â”€â”€ execute.queue.ts
â”‚   â”œâ”€â”€ schemas/         # éªŒè¯Schema
â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ config/          # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ server.ts        # æœåŠ¡å…¥å£
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma    # æ•°æ®åº“Schema
```

## ğŸ” å®‰å…¨æªæ–½

### 1. ä»£ç æ‰§è¡Œå®‰å…¨
- Dockerå®¹å™¨éš”ç¦»
- ç¦ç”¨ç½‘ç»œè®¿é—®
- èµ„æºé™åˆ¶ï¼ˆCPUã€å†…å­˜ã€æ—¶é—´ï¼‰
- åªè¯»æ–‡ä»¶ç³»ç»Ÿ
- érootç”¨æˆ·è¿è¡Œ

### 2. APIå®‰å…¨
- JWTèº«ä»½è®¤è¯
- è¯·æ±‚é¢‘ç‡é™åˆ¶
- è¾“å…¥éªŒè¯
- XSSé˜²æŠ¤
- CSRFé˜²æŠ¤

### 3. æ•°æ®å®‰å…¨
- å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆbcryptï¼‰
- HTTPSä¼ è¾“
- SQLæ³¨å…¥é˜²æŠ¤ï¼ˆPrisma ORMï¼‰

## ğŸš€ éƒ¨ç½²æµç¨‹

### å¼€å‘ç¯å¢ƒéƒ¨ç½²
```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/Dajucoder/Online-Compilation-System.git
cd Online-Compilation-System

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶

# 3. å¯åŠ¨Docker Compose
docker-compose up -d

# 4. åˆå§‹åŒ–æ•°æ®åº“
cd backend
npm install
npx prisma migrate dev
npx prisma db seed

# 5. è®¿é—®åº”ç”¨
# å‰ç«¯: http://localhost:3000
# åç«¯: http://localhost:8000
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# 1. é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
cp .env.example .env.production
# ç¼–è¾‘ç”Ÿäº§ç¯å¢ƒé…ç½®

# 2. æ„å»ºé•œåƒ
docker-compose -f docker-compose.prod.yml build

# 3. å¯åŠ¨æœåŠ¡
docker-compose -f docker-compose.prod.yml up -d

# 4. é…ç½®HTTPSï¼ˆæ¨èä½¿ç”¨Let's Encryptï¼‰
# 5. é…ç½®åŸŸåDNS
# 6. é…ç½®é˜²ç«å¢™è§„åˆ™
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. å‰ç«¯ä¼˜åŒ–
- ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰
- æ‡’åŠ è½½
- CDNåŠ é€Ÿé™æ€èµ„æº
- Gzipå‹ç¼©
- ç¼“å­˜ç­–ç•¥

### 2. åç«¯ä¼˜åŒ–
- æ•°æ®åº“ç´¢å¼•
- Redisç¼“å­˜
- è¿æ¥æ± 
- å¼‚æ­¥ä»»åŠ¡å¤„ç†
- è´Ÿè½½å‡è¡¡

### 3. Dockerä¼˜åŒ–
- å®¹å™¨æ± é¢„çƒ­
- é•œåƒå±‚ç¼“å­˜
- å¤šé˜¶æ®µæ„å»º
- èµ„æºé…é¢ç®¡ç†

## ğŸ› å¸¸è§é—®é¢˜

### 1. Dockeræƒé™é—®é¢˜
```bash
# æ·»åŠ ç”¨æˆ·åˆ°dockerç»„
sudo usermod -aG docker $USER
newgrp docker
```

### 2. ç«¯å£å ç”¨
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep :3000
# æˆ–ä½¿ç”¨å…¶ä»–ç«¯å£
```

### 3. æ•°æ®åº“è¿æ¥å¤±è´¥
- æ£€æŸ¥PostgreSQLæœåŠ¡çŠ¶æ€
- éªŒè¯DATABASE_URLé…ç½®
- æ£€æŸ¥ç½‘ç»œè¿æ¥

## ğŸ“ˆ ç›‘æ§ä¸æ—¥å¿—

### æ—¥å¿—ä½ç½®
- å‰ç«¯: æµè§ˆå™¨æ§åˆ¶å°
- åç«¯: `backend/logs/`
- Nginx: `/var/log/nginx/`
- Docker: `docker logs <container_name>`

### ç›‘æ§æŒ‡æ ‡
- APIå“åº”æ—¶é—´
- ä»£ç æ‰§è¡Œæ—¶é—´
- å®¹å™¨èµ„æºä½¿ç”¨
- é”™è¯¯ç‡
- å¹¶å‘ç”¨æˆ·æ•°

## ğŸ”„ CI/CDæµç¨‹

### GitHub Actionsç¤ºä¾‹
```yaml
name: CI/CD

on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Build images
        run: docker-compose build
      - name: Run tests
        run: docker-compose run backend npm test
```

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ESLint + Prettier
- éµå¾ªTypeScriptæœ€ä½³å®è·µ
- ç¼–å†™å•å…ƒæµ‹è¯•
- ä»£ç å®¡æŸ¥

### Gitå·¥ä½œæµ
- mainåˆ†æ”¯ï¼šç”Ÿäº§ç¯å¢ƒ
- developåˆ†æ”¯ï¼šå¼€å‘ç¯å¢ƒ
- feature/*ï¼šåŠŸèƒ½åˆ†æ”¯
- bugfix/*ï¼šä¿®å¤åˆ†æ”¯

### æäº¤è§„èŒƒ
```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·é“¾æ›´æ–°
```

## ğŸ¯ æœªæ¥è§„åˆ’

1. **åŠŸèƒ½æ‰©å±•**
   - [ ] å®æ—¶åä½œç¼–è¾‘
   - [ ] AIä»£ç è¡¥å…¨
   - [ ] é¢˜åº“ç³»ç»Ÿ
   - [ ] ä»£ç åˆ†äº«ç¤¾åŒº

2. **æ€§èƒ½æå‡**
   - [ ] å®¹å™¨æ± ç®¡ç†
   - [ ] åˆ†å¸ƒå¼éƒ¨ç½²
   - [ ] CDNä¼˜åŒ–

3. **å®‰å…¨å¢å¼º**
   - [ ] ä»£ç å®¡è®¡
   - [ ] WAFé˜²æŠ¤
   - [ ] DDoSé˜²æŠ¤

---

ğŸ’¡ å¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿æIssueæˆ–è”ç³»å¼€å‘å›¢é˜Ÿï¼
